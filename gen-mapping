#!/bin/env python3

from bs4 import BeautifulSoup
import requests

def get_soup(uri):
    r = requests.get(uri)
    return BeautifulSoup(r.content, 'html.parser')

# Mana Font
with open("mana.mapping.typ", "w") as f:
    f.write("// This file is autogenerated\n")
    f.write("#let glyphs = (\n")

    s = get_soup("https://mana.andrewgioia.com/cheatsheet.html")
    v = s #.find('div', class_='vectors')
    for t in v.find_all('span', class_='utf'):
        name = t.find(string=True, recursive=False).text.strip().replace('ms-', '')
        code = int(t.find('code').text.replace('&#x', '').replace(';', ''), base=16)
        f.write("\"" + name + "\": " + str(code) + ",\n")
    f.write(")\n")

# Keyrune Font
with open("keyrune.mapping.typ", "w") as f:
    f.write("// This file is autogenerated\n")
    f.write("#let glyphs = (\n")

    s = get_soup("https://keyrune.andrewgioia.com/cheatsheet.html")
    v = s #.find('div', class_='vectors')
    for t in v.find_all('span', class_='utf'):
        name = t.find(string=True, recursive=False).text.strip().replace('ms-', '')
        code = int(t.find('code').text.replace('&#x', '').replace(';', ''), base=16)
        f.write("\"" + name + "\": " + str(code) + ",\n")
    f.write(")\n")
